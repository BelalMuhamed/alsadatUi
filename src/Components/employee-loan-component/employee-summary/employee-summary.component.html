<mat-card class="p-3">
  <h3 class="text-center" style="color:var(--gold); margin-bottom:12px;">سمري الموظف</h3>

  <div *ngIf="isLoading" class="text-center">جاري التحميل...</div>

  <div *ngIf="!isLoading && summary" class="mb-3">
    <div><strong>اسم الموظف:</strong> {{ summary.employeeName }}</div>
    <div><strong>إجمالي القروض:</strong> {{ summary.totalLoansCount }}</div>
    <div><strong>إجمالي المبلغ:</strong> {{ summary.totalBorrowed | number:'1.2-2' }}</div>
    <div><strong>المتبقي:</strong> {{ summary.totalRemaining | number:'1.2-2' }}</div>
    <div><strong>خصم الشهر الحالي:</strong> {{ summary.currentMonthDeduction | number:'1.2-2' }}</div>
  </div>

  <h4 *ngIf="loans && loans.length">قروض الموظف</h4>
  <table mat-table [dataSource]="loans" *ngIf="loans && loans.length">
    <ng-container matColumnDef="loanNumber">
      <th mat-header-cell *matHeaderCellDef>رقم القرض</th>
      <td mat-cell *matCellDef="let l">{{ l.loanNumber }}</td>
    </ng-container>
    <ng-container matColumnDef="amount">
      <th mat-header-cell *matHeaderCellDef>المبلغ</th>
      <td mat-cell *matCellDef="let l">{{ l.loanAmount | number:'1.2-2' }}</td>
    </ng-container>
    <ng-container matColumnDef="remaining">
      <th mat-header-cell *matHeaderCellDef>المتبقي</th>
      <td mat-cell *matCellDef="let l">{{ l.remainingAmount | number:'1.2-2' }}</td>
    </ng-container>
    <ng-container matColumnDef="actions">
      <th mat-header-cell *matHeaderCellDef>إجراءات</th>
      <td mat-cell *matCellDef="let l">
        <button mat-stroked-button color="primary" class="action-btn" (click)="openLoanPayments(l)">الدفعات</button>
      </td>
    </ng-container>

    <tr mat-header-row *matHeaderRowDef="['loanNumber','amount','remaining','actions']"></tr>
    <tr mat-row *matRowDef="let row; columns: ['loanNumber','amount','remaining','actions'];"></tr>
  </table>

  <div class="d-flex justify-content-center mt-3">
    <button mat-stroked-button class="action-btn" (click)="close()">إغلاق</button>
  </div>
</mat-card>
