<div class="w-100 d-flex justify-content-center align-items-center">
  <h2 class="w-25 text-center">الموردون</h2>
</div>
<hr style="border-color: var(--gold); opacity: 0.5; margin: 10px 0;">

@if (!isLoaded) {
  <p class="text-center" style="color: var(--gold);">جاري التحميل...</p>
} @else {
  <div class="w-100 me-auto d-flex justify-content-end">
    <button class="add-coupon-btn"   [routerLink]="['/supplier/add']">

      <mat-icon>add</mat-icon>
      إضافة مورد جديد
    </button>
  </div>

  <!-- Filter Form -->
  <div class="d-flex justify-content-center align-items-center gap-3 my-3">
    <form [formGroup]="form" class="popup-form">
      <div class="w-100 d-block">
        <mat-form-field class="custom-input-theme ms-2" appearance="outline">
          <mat-label>اسم المورد</mat-label>
          <input matInput formControlName="name">
        </mat-form-field>

        <mat-form-field appearance="outline" class="ms-2 custom-input-theme">
          <mat-label>رقم الهاتف</mat-label>
          <input matInput formControlName="phoneNumbers">
        </mat-form-field>
      </div>

      <div class="d-flex justify-content-center">
        <button
          mat-raised-button
          class="add-coupon-btn px-3 ms-2 m-0"
          (click)="applyFilters()"
          type="button"
        >
          <mat-icon aria-hidden="false" aria-label="Search icon">search</mat-icon>
          ابحث
        </button>
        <button
          mat-raised-button
          class="add-coupon-btn px-3 m-0"
          (click)="resetFilters()"
          type="button"
        >
          <mat-icon aria-hidden="false" aria-label="Reset icon">refresh</mat-icon>
          إعادة تعيين
        </button>
      </div>
    </form>
  </div>

  <!-- Table -->
  <div class="table-container mat-elevation-z8">
    <table mat-table [dataSource]="dataSource" class="mat-elevation-z8">
      @for (col of columns; track col.key) {
        <ng-container [matColumnDef]="col.key">
          <th mat-header-cell *matHeaderCellDef>{{ col.label }}</th>
          <td mat-cell *matCellDef="let element">
            @switch (col.type) {
              @case ('boolean') {
                <mat-slide-toggle
                  [checked]="!element[col.key]"
                  (change)="ToggleSupplierStatus(element, $event.checked)"
                  class="delete-toggle"
                ></mat-slide-toggle>
              }
              @case ('actions') {
               <div class="action-buttons">
          <!-- Updated Edit Button -->
          <button
            mat-icon-button
            color="primary"
            class="border-0 bg-transparent"
            [routerLink]="['/supplier/edit', element.id]"
          >
            <mat-icon>edit</mat-icon>
          </button>
        </div>
              }
              @default {
                <span>{{ element[col.key] ?? '-' }}</span>
              }
            }
          </td>
        </ng-container>
      }

      <tr mat-header-row *matHeaderRowDef="displayedColumnKeys"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumnKeys"></tr>
    </table>

    <div dir="rtl" class="paginator-container">
      <mat-paginator
        [length]="totalCount"
         [pageSize]="filters.pageSize"
    [pageIndex]="(filters.page ?? 1) - 1"
    [pageSizeOptions]="[5, 10, 20,50,70,100]"
        [showFirstLastButtons]="true"
        (page)="onPageChange($event)"
        aria-label="جدول الموردون"
      ></mat-paginator>
    </div>
  </div>
}
